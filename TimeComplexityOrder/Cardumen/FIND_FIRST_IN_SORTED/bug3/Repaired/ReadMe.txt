This repaired program is verified ("ESC_Repaired.txt" is empty), but it changes the order of time complexity. 
